<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Vesak Festival Greeting Cards</title>
  <style>
    /* (your existing CSS remains unchanged) */
    /* You can keep the entire CSS as you had it */
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Vesak Festival Greeting Cards</h1>
      <p class="subtitle">Send beautiful Vesak wishes to your loved ones</p>
    </header>

    <div id="cardCreator" class="card-creator">
      <h2>Step 1: Choose a card design</h2>
      <div class="card-selection">
        <div class="card" data-card="1" onclick="selectCard(1)">
          <img src="Vesak-greetings/Card1.png" alt="Vesak card design 1" />
          <div class="card-label">Lotus Design</div>
        </div>
        <div class="card" data-card="2" onclick="selectCard(2)">
          <img src="Vesak-greetings/Card2.png" alt="Vesak card design 2" />
          <div class="card-label">Buddha Design</div>
        </div>
        <div class="card" data-card="3" onclick="selectCard(3)">
          <img src="Vesak-greetings/Card3.png" alt="Vesak card design 3" />
          <div class="card-label">Lantern Design</div>
        </div>
        <div class="card" data-card="4" onclick="selectCard(4)">
          <img src="Vesak-greetings/Card4.png" alt="Vesak card design 4" />
          <div class="card-label">Temple Design</div>
        </div>
      </div>

      <div class="form-section">
        <h2>Step 2: Personalize your card</h2>
        <div id="cardForm">
          <div class="form-group">
            <label for="senderName">Your Name:</label>
            <input type="text" id="senderName" placeholder="Enter your name" />
          </div>
          <div class="form-group">
            <label for="recipientName">Recipient's Name:</label>
            <input type="text" id="recipientName" placeholder="Enter recipient's name" />
          </div>
          <div class="form-group">
            <label for="personalMessage">Additional Personal Message (Optional):</label>
            <textarea id="personalMessage" placeholder="Write your personal message here..."></textarea>
          </div>
          <button onclick="createCard()">Create Card</button>
        </div>
      </div>
    </div>

    <div id="cardPreview" class="card-preview hidden">
      <h2>Your Vesak Greeting Card</h2>
      <div class="card-inner">
        <div class="card-front">
          <img id="previewImage" class="card-preview-img" src="" alt="Card front" />
        </div>
        <div class="card-back">
          <h2>සුබ වෙසක් මංගල්යක් වේවා!</h2>
          <p class="card-message">May the peace and blessings of Vesak be with you.</p>
          <p id="personalMessageDisplay"></p>
          <p class="signature">With love,<br /><span id="senderNameDisplay"></span></p>
        </div>
      </div>
      <p class="flip-instructions">Click the card to flip it</p>
      <div class="share-section">
        <h3>Share this card with <span id="recipientNameDisplay"></span></h3>
        <p>Copy this link and send it to them:</p>
        <input type="text" id="shareUrl" class="share-url" readonly />
        <button onclick="copyShareLink()">Copy Link</button>
        <div id="copySuccess" class="success-message hidden">Link copied successfully!</div>
        <p>When they open this link, they'll see your special Vesak greeting.</p>
        <button onclick="resetForm()">Create Another Card</button>
      </div>
    </div>

    <div id="receivedCard" class="hidden">
      <div class="success-message">
        <p>You've received a Vesak greeting card! Click to open it.</p>
      </div>
      <div class="card-preview">
        <div class="card-inner">
          <div class="card-front">
            <img id="receivedImage" class="card-preview-img" src="" alt="Card front" />
          </div>
          <div class="card-back">
            <h2>සුබ වෙසක් මංගල්යක් වේවා!</h2>
            <p class="card-message">May the peace and blessings of Vesak be with you.</p>
            <p id="receivedMessage"></p>
            <p class="signature">With love,<br /><span id="receivedFrom"></span></p>
          </div>
        </div>
        <p class="flip-instructions">Click the card to flip it</p>
      </div>
    </div>

    <footer class="vesak-footer">
      <p>Celebrate the spirit of Vesak with peace, love, and happiness.</p>
    </footer>
  </div>

  <script>
    let selectedCard = null;

    window.onload = function () {
      const urlParams = new URLSearchParams(window.location.search);
      if (urlParams.has("card") && urlParams.has("from") && urlParams.has("to")) {
        showReceivedCard(urlParams);
      } else {
        document.getElementById("cardCreator").classList.remove("hidden");
      }

      document.querySelectorAll(".card-preview").forEach((card) => {
        card.addEventListener("click", function () {
          this.classList.toggle("flipped");
        });
      });
    };

    function selectCard(cardNumber) {
      selectedCard = cardNumber;
      document.querySelectorAll(".card").forEach((card) => {
        card.classList.remove("selected");
      });
      document.querySelector(`.card[data-card="${cardNumber}"]`).classList.add("selected");
    }

    function createCard() {
      if (!selectedCard) {
        alert("Please select a card design first.");
        return;
      }

      const senderName = document.getElementById("senderName").value.trim();
      const recipientName = document.getElementById("recipientName").value.trim();
      const personalMessage = document.getElementById("personalMessage").value.trim();

      if (!senderName || !recipientName) {
        alert("Please enter both your name and the recipient's name.");
        return;
      }

      document.getElementById("cardCreator").classList.add("hidden");
      document.getElementById("cardPreview").classList.remove("hidden");

      document.getElementById("previewImage").src = `Vesak-greetings/Card${selectedCard}.png`;
      document.getElementById("personalMessageDisplay").textContent = personalMessage;
      document.getElementById("senderNameDisplay").textContent = senderName;
      document.getElementById("recipientNameDisplay").textContent = recipientName;

      const shareParams = new URLSearchParams();
      shareParams.append("card", selectedCard);
      shareParams.append("from", encodeURIComponent(senderName));
      shareParams.append("to", encodeURIComponent(recipientName));
      if (personalMessage) {
        shareParams.append("msg", encodeURIComponent(personalMessage));
      }

      const shareUrl = `${window.location.origin}${window.location.pathname}?${shareParams.toString()}`;
      document.getElementById("shareUrl").value = shareUrl;
    }

    function showReceivedCard(params) {
      const cardNumber = params.get("card");
      const fromName = params.get("from") ? decodeURIComponent(params.get("from")) : "";
      const toName = params.get("to") ? decodeURIComponent(params.get("to")) : "";
      const message = params.get("msg") ? decodeURIComponent(params.get("msg")) : "";

      document.getElementById("cardCreator").classList.add("hidden");
      document.getElementById("cardPreview").classList.add("hidden");
      document.getElementById("receivedCard").classList.remove("hidden");

      document.getElementById("receivedImage").src = `Vesak-greetings/Card${cardNumber}.png`;
      document.getElementById("receivedMessage").textContent = message;
      document.getElementById("receivedFrom").textContent = fromName;

      document.title = `Vesak Greeting from ${fromName}`;
    }

    function copyShareLink() {
      const shareUrlInput = document.getElementById("shareUrl");
      shareUrlInput.select();
      document.execCommand("copy");

      const successMsg = document.getElementById("copySuccess");
      successMsg.classList.remove("hidden");

      setTimeout(() => {
        successMsg.classList.add("hidden");
      }, 3000);
    }

    function resetForm() {
      document.getElementById("cardCreator").classList.remove("hidden");
      document.getElementById("cardPreview").classList.add("hidden");

      document.getElementById("senderName").value = "";
      document.getElementById("recipientName").value = "";
      document.getElementById("personalMessage").value = "";

      selectedCard = null;
      document.querySelectorAll(".card").forEach((card) => {
        card.classList.remove("selected");
      });
    }
  </script>
</body>
</html>
